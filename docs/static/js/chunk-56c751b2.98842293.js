(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56c751b2"],{"1fcf":function(t,e,o){"use strict";o.d(e,"e",(function(){return a})),o.d(e,"c",(function(){return i})),o.d(e,"h",(function(){return r})),o.d(e,"f",(function(){return s})),o.d(e,"d",(function(){return u})),o.d(e,"g",(function(){return l})),o.d(e,"b",(function(){return c})),o.d(e,"a",(function(){return m}));var n=o("b775");function a(t){return Object(n["a"])({url:"/vue-element-admin/quote/list",method:"get",params:t})}function i(t){return Object(n["a"])({url:"/vue-element-admin/quote/create",method:"post",data:t})}function r(t){return Object(n["a"])({url:"/vue-element-admin/quote/update",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/vue-element-admin/quote/items",method:"get",params:t})}function u(t){return Object(n["a"])({url:"/vue-element-admin/quote/delete",method:"delete",data:t})}function l(){return Object(n["a"])({url:"/vue-element-admin/quote/getLatestQuoteNumber",method:"get"})}function c(t){return Object(n["a"])({url:"/vue-element-admin/quote/number",method:"get",params:t})}function m(t){return Object(n["a"])({url:"/vue-element-admin/quote/checkContext",method:"get",params:t})}},"22fc":function(t,e,o){"use strict";o("5e77")},"5e77":function(t,e,o){},"69c7":function(t,e,o){"use strict";o("f377")},bf19:function(t,e,o){"use strict";var n=o("23e7");n({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},c4c8:function(t,e,o){"use strict";o.d(e,"e",(function(){return a})),o.d(e,"d",(function(){return i})),o.d(e,"a",(function(){return r})),o.d(e,"b",(function(){return s})),o.d(e,"c",(function(){return u})),o.d(e,"f",(function(){return l})),o.d(e,"g",(function(){return c}));var n=o("b775");function a(t){return Object(n["a"])({url:"/vue-element-admin/product/list",method:"get",params:t})}function i(){return Object(n["a"])({url:"/vue-element-admin/product/lastid",method:"get"})}function r(t){return Object(n["a"])({url:"/vue-element-admin/product/add",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/vue-element-admin/product/delete",method:"delete",data:t})}function u(t){return Object(n["a"])({url:"/vue-element-admin/product/edit",method:"post",data:t})}function l(){return Object(n["a"])({url:"/vue-element-admin/product/category",method:"get"})}function c(t){return Object(n["a"])({url:"/vue-element-admin/product/findProduct",method:"get",params:{name:t}})}},ee97:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"float-button"},[t.isEdit&&""!=t.previousQuote?o("el-tooltip",{attrs:{content:t.previousQuote,placement:"top-end"}},[o("el-button",{attrs:{icon:"el-icon-arrow-left",type:"primary"},on:{click:function(e){return t.jump(t.previousQuote)}}},[t._v("Previous")])],1):t._e(),t.isEdit&&""!=t.nextQuote?o("el-tooltip",{attrs:{content:t.nextQuote,placement:"top-end"}},[o("el-button",{attrs:{icon:"el-icon-arrow-right",type:"primary"},on:{click:function(e){return t.jump(t.nextQuote)}}},[t._v("Next")])],1):t._e()],1),o("el-form",{ref:"quote",staticStyle:{"margin-right":"30px"},attrs:{model:t.quote,"label-width":"120px",rules:t.rules}},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"Quote No.:",prop:"quoteNumber"}},[o("el-input",{attrs:{disabled:t.isEdit,placeholder:"KIxxxx-xxx"},model:{value:t.quote.quoteNumber,callback:function(e){t.$set(t.quote,"quoteNumber",e)},expression:"quote.quoteNumber"}})],1)],1),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"Quote date:",prop:"dateQuote"}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Pick a date","value-format":"yyyy-MM-dd"},model:{value:t.quote.dateQuote,callback:function(e){t.$set(t.quote,"dateQuote",e)},expression:"quote.dateQuote"}})],1)],1),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"Owner",prop:"owner"}},[o("el-select",{attrs:{filterable:"",remote:"","remote-method":t.getUserList,placeholder:"Please select","automatic-dropdown":""},model:{value:t.quote.owner,callback:function(e){t.$set(t.quote,"owner",e)},expression:"quote.owner"}},t._l(t.ownerList,(function(t,e){return o("el-option",{key:t+e,attrs:{label:t,value:t}})})),1)],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"Contact",prop:"contact"}},[o("el-select",{attrs:{"value-key":"id",filterable:"",remote:"","remote-method":t.getContactList,placeholder:"Please select","default-first-option":"","no-data-text":"No such contact, please add"},on:{change:t.selectContact},model:{value:t.quote.contact,callback:function(e){t.$set(t.quote,"contact",e)},expression:"quote.contact"}},t._l(t.contactOptionList,(function(t){return o("el-option",{key:t.contactId,attrs:{label:t.contactName,value:t}})})),1)],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"Company",prop:"company"}},[o("el-select",{attrs:{"value-key":"id",filterable:"",remote:"","default-first-option":"","remote-method":t.getCompanyList,placeholder:"Please select","no-data-text":"No such company, please add"},on:{change:t.selectCompany},model:{value:t.quote.company,callback:function(e){t.$set(t.quote,"company",e)},expression:"quote.company"}},t._l(t.companyOptionList,(function(t){return o("el-option",{key:t.companyId,attrs:{label:t.company,value:t}})})),1)],1)],1)],1),o("el-form-item",{attrs:{label:"Greeting",prop:"greeting"}},[o("el-input",{attrs:{type:"textarea",rows:2},model:{value:t.quote.greeting,callback:function(e){t.$set(t.quote,"greeting",e)},expression:"quote.greeting"}})],1),o("el-form-item",{attrs:{label:"Ending",prop:"ending"}},[o("el-input",{attrs:{type:"textarea",rows:2},model:{value:t.quote.ending,callback:function(e){t.$set(t.quote,"ending",e)},expression:"quote.ending"}})],1),o("ComplexTable",{attrs:{quotenumber:t.PassQuoteNumber,ListItems:t.items},on:{itemChange:t.itemChange}}),o("div",[o("el-row",[o("div",[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"Currency",prop:"currency"}},[o("el-select",{staticClass:"filter-item",model:{value:t.quote.currency,callback:function(e){t.$set(t.quote,"currency",e)},expression:"quote.currency"}},t._l(t.CurrencyType,(function(t){return o("el-option",{key:t.key,attrs:{label:t.display_name,value:t.key}})})),1)],1)],1),o("el-col",{attrs:{span:6,offset:7}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"Direct discount"}},[o("el-input-number",{on:{change:t.updateTotal},model:{value:t.quote.discountDirect,callback:function(e){t.$set(t.quote,"discountDirect",e)},expression:"quote.discountDirect"}})],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"Trade Term"}},[o("el-input",{model:{value:t.quote.tradeTerm,callback:function(e){t.$set(t.quote,"tradeTerm",e)},expression:"quote.tradeTerm"}})],1)],1),o("el-col",{attrs:{span:6,offset:5}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"Discount %"}},[o("el-input-number",{on:{change:t.updateTotal},model:{value:t.quote.discount,callback:function(e){t.$set(t.quote,"discount",e)},expression:"quote.discount"}})],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"Price"}},[o("el-input",{model:{value:t.quote.price,callback:function(e){t.$set(t.quote,"price",e)},expression:"quote.price"}})],1)],1),o("el-col",{attrs:{span:6,offset:5}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"VAT %"}},[o("el-input-number",{on:{change:t.updateTotal},model:{value:t.quote.vat,callback:function(e){t.$set(t.quote,"vat",e)},expression:"quote.vat"}})],1)],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"Delivery"}},[o("el-input",{model:{value:t.quote.delivery,callback:function(e){t.$set(t.quote,"delivery",e)},expression:"quote.delivery"}})],1)],1),o("el-col",{attrs:{span:6,offset:5}},[o("hr",{staticStyle:{"margin-bottom":"0","margin-top":"0"}}),o("el-form-item",{staticClass:"narrow",attrs:{label:"Total"}},[o("el-input-number",{attrs:{controls:!1,precision:2,disabled:!0},model:{value:t.quote.total,callback:function(e){t.$set(t.quote,"total",e)},expression:"quote.total"}})],1)],1)],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"Payment Term"}},[o("el-input",{model:{value:t.quote.payment,callback:function(e){t.$set(t.quote,"payment",e)},expression:"quote.payment"}})],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"Validity"}},[o("el-input",{model:{value:t.quote.validity,callback:function(e){t.$set(t.quote,"validity",e)},expression:"quote.validity"}})],1)],1),o("el-col",{attrs:{span:7,offset:3}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"Category",prop:"category"}},[o("el-radio-group",{model:{value:t.quote.category,callback:function(e){t.$set(t.quote,"category",e)},expression:"quote.category"}},t._l(t.CategoryList,(function(e){return o("el-radio",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"narrow",attrs:{label:"Warranty"}},[o("el-input",{model:{value:t.quote.warranty,callback:function(e){t.$set(t.quote,"warranty",e)},expression:"quote.warranty"}})],1)],1),o("el-col",{attrs:{span:7,offset:4}},[o("el-button",{attrs:{type:"success"},on:{click:function(e){t.isEdit?t.editQuote():t.addQuote()}}},[t._v("Save")])],1)],1)],1)],1)},a=[],i=o("b85c"),r=o("c7eb"),s=o("1da1"),u=(o("a9e3"),o("d81d"),o("b0c0"),o("a15b"),o("bf19"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("div",[o("el-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("Add")])],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.list,stripe:"",fit:"","highlight-current-row":""}},[o("el-table-column",{attrs:{label:"No.",type:"index",align:"center",width:"auto","min-width":"10%"}}),o("el-table-column",{attrs:{label:"Item",align:"Left",width:"auto","min-width":"30%","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",{staticStyle:{"text-align":"left"}},[t._v(t._s(e.row.item))])]}}])}),o("el-table-column",{attrs:{label:"Quantity",width:"auto",align:"center","min-width":"15%"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[o("el-input-number",{attrs:{size:"mini",min:1},on:{change:t.handleQuantityChange},model:{value:n.quantity,callback:function(e){t.$set(n,"quantity",e)},expression:"row.quantity"}},[t._v(" "+t._s(n.quantity)+" ")])]}}])}),o("el-table-column",{attrs:{label:"Unit price",width:"auto",align:"center","min-width":"15%"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[o("span",{staticClass:"decimal"},[t._v(t._s(t.decFormat(n.price)))])]}}])}),o("el-table-column",{attrs:{label:"Sum",width:"auto",align:"center","min-width":"15%"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[o("span",{staticClass:"decimal"},[t._v(t._s(t.decFormat(n.price*n.quantity)))])]}}])}),o("el-table-column",{attrs:{label:"Actions",align:"center",width:"auto","class-name":"small-padding fixed-width","min-width":"15%"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row,a=e.$index;return[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.handleEdit(n,a)}}}),o("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(e){return t.handleDelete(n,a)}}})],1)]}}])})],1),o("br"),o("el-col",{attrs:{span:6,offset:15}},[o("el-form-item",{attrs:{label:"Subtotal"}},[o("el-input-number",{staticStyle:{width:"100px"},attrs:{type:"text",precision:2,disabled:!0,controls:!1},model:{value:t.subtotal,callback:function(e){t.subtotal=e},expression:"subtotal"}})],1)],1),o("br"),o("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,"close-on-click-modal":!1,"before-close":t.closeDialog},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("el-form",{ref:"dataForm",staticStyle:{"margin-left":"20px","margin-right":"40px"},attrs:{rules:t.rules,model:t.temp,"label-width":"85px"}},[o("el-form-item",{attrs:{label:"Product",prop:"productname"}},[o("el-cascader",{staticStyle:{width:"260px","margin-bottom":"20px"},attrs:{options:t.optionedItme,filterable:"","default-first-option":""},on:{change:t.handleOptionChange},model:{value:t.tempOption,callback:function(e){t.tempOption=e},expression:"tempOption"}})],1),o("el-form-item",{attrs:{label:"Item",prop:"item"}},[o("el-input",{model:{value:t.temp.item,callback:function(e){t.$set(t.temp,"item",e)},expression:"temp.item"}})],1),o("el-form-item",{attrs:{label:"Price",prop:"price"}},[o("el-input-number",{attrs:{controls:!1,precision:2},model:{value:t.temp.price,callback:function(e){t.$set(t.temp,"price",e)},expression:"temp.price"}})],1),o("el-form-item",{attrs:{label:"Quote text",prop:"text"}},[o("el-input",{attrs:{type:"textarea",placeholder:"Quote text",rows:"4"},model:{value:t.temp.quotetext,callback:function(e){t.$set(t.temp,"quotetext",e)},expression:"temp.quotetext"}})],1),o("el-form-item",{attrs:{label:"Comments",prop:"comments"}},[o("el-input",{attrs:{type:"textarea",placeholder:"Comments(optional)",rows:"4"},model:{value:t.temp.comments,callback:function(e){t.$set(t.temp,"comments",e)},expression:"temp.comments"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.closeDialog}},[t._v(" Close ")]),"Add"===t.dialogStatus?o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addItem()}}},[t._v(" Add ")]):t._e(),"Edit"===t.dialogStatus?o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editItem()}}},[t._v(" Confirm ")]):t._e()],1)],1)],1)}),l=[],c=o("2909"),m=o("ade3"),d=(o("a434"),o("b680"),o("caad"),o("2532"),o("ac1f"),o("5319"),o("c4c8")),p={name:"ComplexTable",props:["quotenumber","ListItems"],data:function(){var t;return t={picDialogImageUrl:"",picDialogVisible:!1,picList:[],optionedItme:[],list:[],listLoading:!0,QueryList:{quotenumber:""},rules:{price:[{required:!0,message:"This is mandatory",trigger:"blur"},{type:"number",transform:function(t){return""===t?0:Number(t)},trigger:"blur"}]},temp:{},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"Edit",create:"Create"},dialogPvVisible:!1,pvData:[]},Object(m["a"])(t,"textMap",{Edit:"Edit",Add:"Add a new item"}),Object(m["a"])(t,"dialogStatus",""),Object(m["a"])(t,"downloadLoading",!1),Object(m["a"])(t,"subtotal",0),Object(m["a"])(t,"Items",[]),Object(m["a"])(t,"uniqueKey",584651274321768),Object(m["a"])(t,"dialogVisible",!0),Object(m["a"])(t,"tempOption",""),Object(m["a"])(t,"editingRow",0),Object(m["a"])(t,"tempQuoteVO",""),t},watch:{quotenumber:function(t,e){this.QueryList.quotenumber=this.quotenumber,this.getList()}},computed:{},created:function(){var t=this;console.log("subform-created"),this.resetTemp(),this.listLoading=!1,this.list=this.ListItems,Object(d["f"])().then((function(e){t.optionedItme=Object(c["a"])(e.data)})),this.updateSubtotal()},mounted:function(){},methods:{handleChangePic:function(t,e){console.log(t,e),this.temp.pic=t,e.length>1&&e.splice(0,1)},handleRemove:function(t,e){console.log(t,e)},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},getList:function(){var t=this;return Object(s["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.listLoading=!0,console.log("items=>getList()"),t.list=t.ListItems,t.listLoading=!1,t.updateSubtotal();case 5:case"end":return e.stop()}}),e)})))()},handleAdd:function(){this.dialogFormVisible=!0,this.dialogStatus="Add"},handleItemChange:function(t){console.log(t)},resetTemp:function(){this.temp={item:"",price:"",quotetext:"",id:"",comments:"",pic:""},this.picList=[]},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},handleEdit:function(t,e){var o=this;return Object(s["a"])(Object(r["a"])().mark((function n(){return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:console.log("handelEdit"),o.editingRow=e,o.tempOption=[{},{}],console.log(t),o.temp.item=t.item,o.temp.id=t.id,o.temp.quotetext=t.text,o.temp.quantity=t.quantity,o.temp.price=t.price,o.temp.comments=t.comments,t.pic&&(o.picList[0]=t.pic),o.tempOption[0]="",o.tempOption[1]="",o.dialogFormVisible=!0,o.dialogStatus="Edit",o.$forceUpdate();case 16:case"end":return n.stop()}}),n)})))()},handleDelete:function(t,e){this.$notify({title:"Success",message:"Delete Successfully",type:"success",duration:2e3}),this.list.splice(e,1),this.handleQuantityChange()},handleQuantityChange:function(){console.log("handelQuantityChange()"),console.log(this.list),this.$emit("itemChange",this.list),this.updateSubtotal()},updateSubtotal:function(){if(this.subtotal=0,this.list){var t,e=Object(i["a"])(this.list);try{for(e.s();!(t=e.n()).done;){var o=t.value;this.subtotal+=o.price*o.quantity}}catch(n){e.e(n)}finally{e.f()}}this.$emit("itemChange",this.list)},handleOptionChange:function(){var t=this;console.log(this.tempOption[1]),Object(d["g"])(this.tempOption[1]).then((function(e){var o=e.data;console.log(o),t.temp.item=o.productname,t.temp.quotetext=o.quotetext,t.temp.currency=o.currency,t.temp.quantity=1,t.temp.price=o.price,t.$forceUpdate()})),console.log(this.tempOption)},closeDialog:function(){this.dialogFormVisible=!1,this.resetTemp(),this.tempOption=""},addItem:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&(console.log("children->addItem"),t.saveItem(-1),t.$notify({title:"Success",message:"Item is successfully added",type:"success",duration:2e3}),t.dialogFormVisible=!1,t.resetTemp(),t.tempOption="")}))},editItem:function(){var t=this;this.$refs["dataForm"].validate((function(e){if(e){var o=t.editingRow;t.saveItem(o),t.$notify({title:"Success",message:"Item is successfully added",type:"success",duration:2e3}),t.dialogFormVisible=!1,t.resetTemp()}}))},saveItem:function(t){if(t<0){console.log("saveItem - add");var e={};console.log(this.temp),e.item=this.temp.item,e.comments=this.temp.comments,e.quantity=1,e.price=this.temp.price?this.temp.price:0,e.quoteNumber=this.quotenumber,e.text=this.temp.quotetext,this.list.push(e)}else console.log("saveItem - edit"),console.log(this.list[t]),console.log(this.temp),this.list[t].id=this.temp.id,this.list[t].item=this.temp.item,this.list[t].quantity=this.temp.quantity,this.list[t].price=this.temp.price,this.list[t].quoteNumber=this.quotenumber,this.list[t].text=this.temp.quotetext,this.list[t].comments=this.temp.comments,this.list[t].pic=this.temp.pic,console.log(this.list[t]);this.updateSubtotal()},decFormat:function(t){return t=parseFloat(t).toFixed(2),t+="",t.includes(".")||(t+="."),t.replace(/(\d)(?=(\d{3})+\.)/g,(function(t,e){return e+","})).replace(/\.$/,"")}}},f=p,b=(o("69c7"),o("2877")),h=Object(b["a"])(f,u,l,!1,null,null,null),g=h.exports,y=o("1fcf"),v=o("c24f"),q=o("f6b0"),w=[{key:"USD",value:"USD"},{key:"GBP",value:"GBP"},{key:"Euro",value:"Euro"}],O=[{key:"CFL",value:"CFL",label:"CFL"},{key:"PU",value:"PU",label:"PU"},{key:"DA",value:"DA",label:"DA"},{key:"MOTOR",value:"MOTOR",label:"MOTOR"}],x={name:"create",components:{ComplexTable:g},props:{isEdit:{type:Boolean,default:!1}},data:function(){return{previousQuote:"",nextQuote:"",gotList:!1,CategoryList:O,ownerList:[],contactOptionList:[],companyOptionList:[],quote:{quoteNumber:"",currency:"",vat:"",discountDirect:"",discount:"",total:"",company:"",companyId:"",contact:"",contactId:"",greeting:"",owner:"",dateQuote:"",ending:"",price:"",tradeTerm:"",delivery:"",payment:"",validity:"",warranty:"",category:""},initQuoteVo:{},CurrencyType:w,items:[],rules:{quoteNumber:[{required:!0,message:"This is mandatory",trigger:"blur"}],dateQuote:[{required:!0,message:"This is mandatory",trigger:"blur"}],owner:[{required:!0,message:"This is mandatory",trigger:"change"}],company:[{required:!0,message:"This is mandatory",trigger:"blur"}],category:[{required:!0,message:"This is mandatory",trigger:"blur"}],currency:[{required:!0,message:"This is mandatory",trigger:"blur"}],nnn:[{required:!0,message:"This is mandatory",trigger:"blur"},{type:"number",transform:function(t){return""===t?0:Number(t)},trigger:"blur"}]},quoteItem:{quotenumber:""},PassQuoteNumber:"",subtotal:0,tempQuoteItemQueryVO:""}},created:function(){var t=this;if(console.log("created"),Object(v["f"])("").then((function(e){e.data&&(t.ownerList=e.data.map((function(t){return t.name})))})),this.isEdit)this.fetchDate(this.$route.params.id),this.remoteCheckContext(this.$route.params.id);else{var e=new Date((new Date).getTime()+288e5);this.quote.dateQuote=e.toJSON().split("T").join(" ").substring(0,10),this.latestQuoteNumber(),this.quote.currency="USD",console.log(this.quote)}this.initQuoteVo=Object.assign({},this.tempQuoteItemQueryVO)},mounted:function(){},beforeDestroy:function(){},updated:function(){},watch:{quote:function(t){console.log(t)},deep:!0},methods:{latestQuoteNumber:function(){var t=this;return Object(s["a"])(Object(r["a"])().mark((function e(){var o,n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["g"])();case 2:o=e.sent,t.quote.quoteNumber=o.data,console.log(t.quote.dateQuote),10===t.quote.quoteNumber.length?(n=parseInt(t.quote.quoteNumber.substring(7,10)),n+=1,t.quote.quoteNumber="KI"+t.quote.dateQuote.substring(2,4)+t.quote.dateQuote.substring(5,7)+"_"+n):t.quote.quoteNumber="";case 6:case"end":return e.stop()}}),e)})))()},fetchDate:function(t){var e=this;console.log("fetch"),console.log(t),this.quoteItem.quotenumber=t,Object(y["f"])(this.quoteItem).then((function(t){e.tempQuoteItemQueryVO=t.data,console.log(e.tempQuoteItemQueryVO),e.quote=t.data.quote,e.items=t.data.itemList,e.PassQuoteNumber=e.quote.quoteNumber,e.gotList=!0})).catch((function(t){console.log(t)}))},onSubmit:function(){this.$message("submit!")},onCancel:function(){this.$message({message:"cancel!",type:"warning"})},addQuote:function(){var t=this;return Object(s["a"])(Object(r["a"])().mark((function e(){var o,n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["b"])({quotenumber:t.quote.quoteNumber});case 2:o=e.sent,n="EXIST"===o.data,console.log(n),n?t.$message({type:"error",message:"Quote number already exists, please change",duration:3e3}):t.$refs["quote"].validate((function(e){if(console.log(e),e){t.quote.company=t.quote.companyId,t.quote.contact=t.quote.contactId;var o={quote:t.quote,itemList:t.items};console.log("adddQuote"),console.log(o),Object(y["c"])(o).then(t.$message({type:"success",message:"Quote successfully added"})),t.$router.push({path:"/quote/list"})}}));case 6:case"end":return e.stop()}}),e)})))()},editQuote:function(){var t=this;this.$refs["quote"].validate((function(e){if(console.log(e),e){console.log("editQuote"),console.log(t.quote),t.quote.company=t.quote.companyId,t.quote.contact=t.quote.contactId;var o={quote:t.quote,itemList:t.items};console.log(o),Object(y["h"])(o).then(t.$message({type:"success",message:"Successfully saved"}))}}))},itemChange:function(t){if(console.log("parent->itemchange"),t.length>0){console.log(t);var e,o=0,n=Object(i["a"])(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;o+=a.price*(1*a.quantity)}}catch(r){n.e(r)}finally{n.f()}console.log(o),this.subtotal=o,this.quote.total=(o-this.quote.discountDirect)*(1-this.quote.discount/100)*(1+this.quote.vat/100)}},updateTotal:function(){this.quote.total=(this.subtotal-this.quote.discountDirect)*(1-this.quote.discount/100)*(1+this.quote.vat/100)},getUserList:function(t){},getContactList:function(t){var e=this;this.loading=!0,Object(q["h"])(t).then((function(t){t.data&&(e.contactOptionList=t.data.map((function(t){return{contactId:t.id,contactName:t.firstname+" "+t.lastname}})),console.log(e.contactOptionList))})).then(this.loading=!1)},getCompanyList:function(t){var e=this;this.loading=!0,Object(q["g"])(t).then((function(t){t.data&&(e.companyOptionList=t.data.map((function(t){return{companyId:t.id,company:t.company}})),console.log(e.companyOptionList))})).then(this.loading=!1)},quoteNumber:function(t){var e={quotenumber:t};Object(y["b"])(e).then((function(t){return console.log(t),"EXIST"===t.data}))},selectContact:function(t){console.log(t),this.quote.contact=t.contactName,this.quote.contactId=t.contactId,console.log(this.quote)},selectCompany:function(t){console.log(t),this.quote.company=t.company,this.quote.companyId=t.companyId,console.log(this.quote)},remoteCheckContext:function(t){var e=this;return Object(s["a"])(Object(r["a"])().mark((function o(){var n,a;return Object(r["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n={quotenumber:t},o.next=3,Object(y["a"])(n);case 3:a=o.sent,console.log(a),e.previousQuote=a.data.previousQuote?a.data.previousQuote:"",e.nextQuote=a.data.nextQuote?a.data.nextQuote:"",console.log(e.previousQuote),console.log(e.nextQuote);case 9:case"end":return o.stop()}}),o)})))()},jump:function(t){this.$router.push("/quote/list/edit/"+t)}}},j=x,k=(o("22fc"),Object(b["a"])(j,n,a,!1,null,"3fef6a98",null));e["a"]=k.exports},f377:function(t,e,o){},f6b0:function(t,e,o){"use strict";o.d(e,"f",(function(){return a})),o.d(e,"e",(function(){return i})),o.d(e,"c",(function(){return r})),o.d(e,"d",(function(){return s})),o.d(e,"i",(function(){return u})),o.d(e,"j",(function(){return l})),o.d(e,"b",(function(){return c})),o.d(e,"a",(function(){return m})),o.d(e,"g",(function(){return d})),o.d(e,"h",(function(){return p}));var n=o("b775");function a(t){return Object(n["a"])({url:"/vue-element-admin/customer/contact",method:"get",params:t})}function i(t){return Object(n["a"])({url:"/vue-element-admin/customer/company",method:"get",params:t})}function r(t){return Object(n["a"])({url:"/vue-element-admin/customer/company/delete",method:"delete",data:t})}function s(t){return Object(n["a"])({url:"/vue-element-admin/customer/contact/delete",method:"delete",data:t})}function u(t){return Object(n["a"])({url:"/vue-element-admin/customer/company/update",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/vue-element-admin/customer/contact/update",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/vue-element-admin/customer/contact/create",method:"post",data:t})}function m(t){return Object(n["a"])({url:"/vue-element-admin/customer/company/create",method:"post",data:t})}function d(t){return Object(n["a"])({url:"/vue-element-admin/customer/company/searchByName",method:"get",params:{name:t}})}function p(t){return Object(n["a"])({url:"/vue-element-admin/customer/contact/searchByName",method:"get",params:{name:t}})}}}]);